<?xml version="1.0"?>
<robot name="fanuc_crx10_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Include Gazebo plugins -->
  <xacro:property name="pkg_path" value="$(find fanuc_robot)" />
  <xacro:include filename="$(find fanuc_robot)/urdf/gazebo.xacro" />
  <xacro:include filename="$(find fanuc_robot)/urdf/robotic_gripper.xacro"/>
  
  <xacro:macro name="default_inertial" params="mass">
    <inertial>
      <mass value="${mass}" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01" />
    </inertial>
  </xacro:macro>

  <link name="world"/>
  
  <link name="base_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/base_link.stl"/>
      </geometry>
      <material name="fanuc_grey">
        <color rgba="0.239 0.239 0.239 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/base_link.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="5.0"/>
  </link>

  <joint name="world_to_base" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="link_1">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_1.stl"/>
      </geometry>
      <material name="fanuc_white">
        <color rgba="0.86 0.85 0.81 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_1.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="3.0"/>
  </link>

  <link name="link_2">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_2.stl"/>
      </geometry>
      <material name="fanuc_white">
        <color rgba="0.86 0.85 0.81 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_2.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="8.0"/>
  </link>

  <link name="link_3">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_3.stl"/>
      </geometry>
      <material name="fanuc_white">
        <color rgba="0.86 0.85 0.81 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_3.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="3.5"/>
  </link>

  <link name="link_4">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_4.stl"/>
      </geometry>
      <material name="fanuc_white">
        <color rgba="0.86 0.85 0.81 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_4.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="2.0"/>
  </link>

  <link name="link_5">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_5.stl"/>
      </geometry>
      <material name="fanuc_white">
        <color rgba="0.86 0.85 0.81 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_5.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="1.5"/>
  </link>

  <link name="link_6">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/visual/link_6.stl"/>
      </geometry>
      <material name="fanuc_grey">
        <color rgba="0.239 0.239 0.239 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find fanuc_robot)/meshes/collision/link_6.stl"/>
      </geometry>
    </collision>
    <xacro:default_inertial mass="0.5"/>
  </link>

  <joint name="joint_1" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0.245"/>
    <parent link="base_link"/>
    <child link="link_1"/>
    <axis xyz="0 0 1"/>
    <limit effort="100" lower="-3.141592653589793" upper="3.141592653589793" velocity="2.0943951023931953"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <joint name="joint_2" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="link_1"/>
    <child link="link_2"/>
    <axis xyz="0 1 0"/>
    <limit effort="100" lower="-3.141592653589793" upper="3.141592653589793" velocity="2.0943951023931953"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <joint name="joint_3" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0.710"/>
    <parent link="link_2"/>
    <child link="link_3"/>
    <axis xyz="0 -1 0"/>
    <limit effort="100" lower="-4.71238898038469" upper="4.71238898038469" velocity="3.141592653589793"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <joint name="joint_4" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="link_3"/>
    <child link="link_4"/>
    <axis xyz="-1 0 0"/>
    <limit effort="100" lower="-3.3161255787892263" upper="3.3161255787892263" velocity="3.141592653589793"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <joint name="joint_5" type="revolute">
    <origin rpy="0 0 0" xyz="0.540 -0.150 0"/>
    <parent link="link_4"/>
    <child link="link_5"/>
    <axis xyz="0 -1 0"/>
    <limit effort="100" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <joint name="joint_6" type="revolute">
    <origin rpy="0 0 0" xyz="0.160 0 0"/>
    <parent link="link_5"/>
    <child link="link_6"/>
    <axis xyz="-1 0 0"/>
    <limit effort="100" lower="-3.3161255787892263" upper="3.3161255787892263" velocity="3.141592653589793"/>
    <dynamics damping="0.7" friction="0.5"/>
  </joint>

  <link name="base"/>
  <joint name="base_link-base" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0.245"/>
    <parent link="base_link"/>
    <child link="base"/>
  </joint>

  <link name="flange"/>
  <joint name="joint_6-flange" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="link_6"/>
    <child link="flange"/>
  </joint>

  <link name="tool0"/>
  <joint name="link_6-tool0" type="fixed">
    <origin rpy="3.141592653589793 -1.5707963267948966 0" xyz="0 0 0"/>
    <parent link="flange"/>
    <child link="tool0"/>
  </joint>

  <xacro:robotic_gripper parent="tool0"/>

  <!-- ros2_control-->
  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gz_ros2_control/GazeboSimSystem</plugin>
    </hardware>
    <joint name="joint_1">
      <command_interface name="position">
        <param name="min">-3.141592653589793</param>
        <param name="max">3.141592653589793</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="joint_2">
      <command_interface name="position">
        <param name="min">-3.141592653589793</param>
        <param name="max">3.141592653589793</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="joint_3">
      <command_interface name="position">
        <param name="min">-4.71238898038469</param>
        <param name="max">4.71238898038469</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="joint_4">
      <command_interface name="position">
        <param name="min">-3.3161255787892263</param>
        <param name="max">3.3161255787892263</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="joint_5">
      <command_interface name="position">
        <param name="min">-3.141592653589793</param>
        <param name="max">3.141592653589793</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="joint_6">
      <command_interface name="position">
        <param name="min">-3.3161255787892263</param>
        <param name="max">3.3161255787892263</param>
      </command_interface>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>

    <joint name="left_finger_joint">
        <command_interface name="position"/>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
    </joint>

    <joint name="right_finger_joint">
        <command_interface name="position"/>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
    </joint>

  </ros2_control>

  <!-- gazebo ros2_control plugin -->
  <gazebo>
    <plugin filename="gz_ros2_control-system" name="gz_ros2_control::GazeboSimROS2ControlPlugin">
        <parameters>${pkg_path}/config/ros2_controllers.yaml</parameters>
    </plugin>
  </gazebo>

</robot>